import{r as t,j as s}from"./index-B8XRob5j.js";import{C as g}from"./react-apexcharts.min-BIM3EKlp.js";function b({className:f}){const[i,d]=t.useState([]),[p,h]=t.useState(!1),n=t.useRef(!1),x=t.useMemo(()=>{const e=[],r=[],l=[],m=[],u=[],y=[];return i.forEach(a=>{const o=new Date(a[3]).getTime();e.push({x:o,y:a[4]}),r.push({x:o,y:a[5]}),l.push({x:o,y:a[6]}),m.push({x:o,y:a[7]}),u.push({x:o,y:a[8]}),y.push({x:o,y:a[9]})}),[{name:"Solar production",data:e},{name:"Battery discharged",data:l},{name:"Battery charged",data:r},{name:"Export to grid",data:u},{name:"Import to user",data:m},{name:"Comsumption",data:y}]},[i]),c=t.useCallback(async()=>{if(n.current)return;n.current=!0;const r=await(await fetch("/daily-chart")).json();d(r),n.current=!1},[d]);return t.useEffect(()=>{c(),document.addEventListener("visibilitychange",()=>{document.hidden||(console.log("Fetch hourly chart when visiblity change"),c())})},[c]),t.useEffect(()=>{const e=window.matchMedia("(prefers-color-scheme: dark)");e.matches&&h(!0),e.addEventListener("change",r=>h(r.matches))},[]),s.jsxs("div",{className:`card daily-chart ${f||""}`,children:[s.jsxs("div",{className:"row justify-space-between",children:[s.jsx("div",{className:"daily-chart-title",children:"Daily Chart"}),s.jsx("div",{className:"row",children:s.jsx("button",{onClick:()=>c(),children:"Update"})})]}),s.jsx("div",{className:"daily-chart-content",children:s.jsx(g,{type:"bar",series:x,options:{chart:{toolbar:{show:!1},height:300},colors:["rgb(112, 173, 70)","rgb(90, 155, 213)","rgb(64, 38, 198)","rgb(246, 104, 103)","rgb(153, 107, 31)","rgb(255, 164, 97)"],theme:{mode:p?"dark":"light"},dataLabels:{enabled:!1},xaxis:{type:"datetime",labels:{datetimeUTC:!1,format:"dd/MM/yyyy"}},tooltip:{x:{format:"dd/MM/yyyy"},y:{formatter(e){return`${e} kWh`}}},yaxis:[{seriesName:"Solar production",title:{text:"kWh"}}]}})})]})}const w=t.memo(b);export{w as default};
