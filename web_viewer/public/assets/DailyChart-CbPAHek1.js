import{r as a,j as t}from"./index--yuavyFR.js";import{C as g}from"./react-apexcharts.min-Cm4rN6FU.js";function b({className:f}){const[n,d]=a.useState([]),[x,l]=a.useState(!1),i=a.useRef(!1),p=a.useMemo(()=>{const e=[],r=[],h=[],m=[],u=[],y=[];return n.forEach(s=>{const c=new Date(s[3]).getTime();e.push({x:c,y:s[4]}),r.push({x:c,y:s[5]}),h.push({x:c,y:s[6]}),m.push({x:c,y:s[7]}),u.push({x:c,y:s[8]}),y.push({x:c,y:s[9]})}),[{name:"Solar production",data:e},{name:"Battery discharged",data:h},{name:"Battery charged",data:r},{name:"Export to grid",data:u},{name:"Import to user",data:m},{name:"Comsumption",data:y}]},[n]),o=a.useCallback(async()=>{if(i.current)return;i.current=!0;const r=await(await fetch("/daily-chart")).json();d(r),i.current=!1},[d]);return a.useEffect(()=>{o(),document.addEventListener("visibilitychange",()=>{document.hidden||o()})},[o]),a.useEffect(()=>{const e=window.matchMedia("(prefers-color-scheme: dark)");e.matches&&l(!0),e.addEventListener("change",r=>l(r.matches))},[]),t.jsxs("div",{className:`card daily-chart col flex-1 ${f||""}`,children:[t.jsxs("div",{className:"row justify-space-between",children:[t.jsx("div",{className:"daily-chart-title",children:"Daily Chart"}),t.jsx("div",{className:"row",children:t.jsx("button",{onClick:()=>o(),children:"Update"})})]}),t.jsx("div",{className:"daily-chart-content col flex-1",children:n.length?t.jsx(g,{type:"bar",series:p,options:{chart:{toolbar:{show:!1},height:300},colors:["rgb(112, 173, 70)","rgb(90, 155, 213)","rgb(64, 38, 198)","rgb(246, 104, 103)","rgb(153, 107, 31)","rgb(255, 164, 97)"],theme:{mode:x?"dark":"light"},dataLabels:{enabled:!1},xaxis:{type:"datetime",labels:{datetimeUTC:!1,format:"dd/MM/yyyy"}},tooltip:{x:{format:"dd/MM/yyyy"},y:{formatter(e){return`${e} kWh`}}},yaxis:[{seriesName:"Solar production",title:{text:"kWh"}}]}}):t.jsx("div",{className:"col flex-1 justify-center align-center",children:"Loadding..."})})]})}const S=a.memo(b);export{S as default};
