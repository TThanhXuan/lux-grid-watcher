const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MonthlyChart-BB1CivBV.js","assets/index-Bjtz3g86.js","assets/index-7DmoOWYM.css","assets/react-apexcharts.min-3bRJqDZ3.js","assets/utils-bN4E_OZW.js","assets/YearlyChart-dKhUmQEo.js"])))=>i.map(i=>d[i]);
import{r as t,j as e,L as x,_ as w}from"./index-Bjtz3g86.js";import{C as M}from"./react-apexcharts.min-3bRJqDZ3.js";import{r as d}from"./utils-bN4E_OZW.js";const c="Solar production",C=t.forwardRef((a,r)=>{const[n,o]=t.useState([]),[u,g]=t.useState(!1),f=t.useRef(!1),N=t.useMemo(()=>{const s=[],l=[],p=[],v=[],b=[],j=[];return n.forEach(i=>{const h=new Date(i[3]).getTime();s.push({x:h,y:d(i[4])}),l.push({x:h,y:d(i[5])}),p.push({x:h,y:d(i[6])}),v.push({x:h,y:d(i[7])}),b.push({x:h,y:d(i[8])}),j.push({x:h,y:d(i[9])})}),[{name:c,data:s},{name:"Battery discharged",data:p},{name:"Battery charged",data:l},{name:"Export to grid",data:b},{name:"Import to user",data:v},{name:"Comsumption",data:j}]},[n]),m=t.useCallback(async()=>{if(f.current)return;f.current=!0;const l=await(await fetch("/daily-chart")).json();o(l),f.current=!1},[o]);t.useImperativeHandle(r,()=>({fetchChart:m}));const y=t.useCallback(()=>{document.hidden||m()},[m]),_=t.useMemo(()=>{const s=new Date;return s.setDate(1),s.setHours(0,0,0,0),s},[]),E=t.useMemo(()=>{const s=new Date;return s.setMonth(s.getMonth()+1),s.setDate(0),s.setHours(23,59,59,999),s},[]);return t.useEffect(()=>(m(),document.addEventListener("visibilitychange",y),()=>document.removeEventListener("visibilitychange",y)),[m,y]),t.useEffect(()=>{const s=window.matchMedia("(prefers-color-scheme: dark)");s.matches&&g(!0),s.addEventListener("change",l=>g(l.matches))},[]),n.length?e.jsx(M,{type:"bar",height:400,series:N.reverse(),options:{chart:{toolbar:{show:!1},zoom:{allowMouseWheelZoom:!1}},colors:["rgb(112, 173, 70)","rgb(90, 155, 213)","rgb(64, 38, 198)","rgb(246, 104, 103)","rgb(153, 107, 31)","rgb(255, 164, 97)"].reverse(),theme:{mode:u?"dark":"light"},dataLabels:{enabled:!1},xaxis:{type:"datetime",min:_.getTime(),max:E.getTime(),labels:{datetimeUTC:!1,format:"dd"}},tooltip:{x:{format:"dd/MM/yyyy"},y:{formatter(s){return`${s} kWh`}}},yaxis:[{seriesName:c,title:{text:"Energy (kWh)"}},{seriesName:c,show:!1},{seriesName:c,show:!1},{seriesName:c,show:!1},{seriesName:c,show:!1},{seriesName:c,show:!1}].reverse()}}):e.jsx(x,{})});C.displayName="DailyChart";const k=t.memo(C),S=t.lazy(()=>w(()=>import("./MonthlyChart-BB1CivBV.js"),__vite__mapDeps([0,1,2,3,4]))),L=t.lazy(()=>w(()=>import("./YearlyChart-dKhUmQEo.js"),__vite__mapDeps([5,1,2,3,4])));var D=(a=>(a[a.Daily=0]="Daily",a[a.Monthly=1]="Monthly",a[a.Yearly=2]="Yearly",a))(D||{});function R({className:a}){const[r,n]=t.useState(0),o=t.useRef(null);return e.jsxs("div",{className:`card col energy-chart ${a}`,children:[e.jsxs("div",{className:"row justify-space-between",children:[e.jsxs("div",{className:"energy-chart-title",children:[D[r]," chart"]}),e.jsxs("div",{className:"row energy-chart-buttons",children:[e.jsx("button",{onClick:()=>{var u;return(u=o==null?void 0:o.current)==null?void 0:u.fetchChart()},children:"Update chart"}),e.jsx("div",{children:"Chart type:"}),e.jsxs("div",{className:"row chart-select",children:[e.jsx("button",{className:r===0?"active":void 0,onClick:()=>n(0),children:"Daily"}),e.jsx("button",{className:r===1?"active":void 0,onClick:()=>n(1),children:"Monthly"}),e.jsx("button",{className:r===2?"active":void 0,onClick:()=>n(2),children:"Yearly"})]})]})]}),e.jsxs("div",{className:"energy-chart-content flex-1 col",children:[r===0&&e.jsx(k,{ref:o}),r===1&&e.jsx(t.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(S,{ref:o})}),r===2&&e.jsx(t.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(L,{ref:o})})]})]})}const A=t.memo(R);export{A as default};
