import{r as a,j as s}from"./index-GjNwB43g.js";import{C as b}from"./react-apexcharts.min-Di4dtRqf.js";const r="Solar production";function w({className:x}){const[n,d]=a.useState([]),[p,h]=a.useState(!1),l=a.useRef(!1),g=a.useMemo(()=>{const e=[],o=[],m=[],f=[],u=[],y=[];return n.forEach(t=>{const i=new Date(t[3]).getTime();e.push({x:i,y:t[4]}),o.push({x:i,y:t[5]}),m.push({x:i,y:t[6]}),f.push({x:i,y:t[7]}),u.push({x:i,y:t[8]}),y.push({x:i,y:t[9]})}),[{name:r,data:e},{name:"Battery discharged",data:m},{name:"Battery charged",data:o},{name:"Export to grid",data:u},{name:"Import to user",data:f},{name:"Comsumption",data:y}]},[n]),c=a.useCallback(async()=>{if(l.current)return;l.current=!0;const o=await(await fetch("/daily-chart")).json();d(o),l.current=!1},[d]);return a.useEffect(()=>{c(),document.addEventListener("visibilitychange",()=>{document.hidden||c()})},[c]),a.useEffect(()=>{const e=window.matchMedia("(prefers-color-scheme: dark)");e.matches&&h(!0),e.addEventListener("change",o=>h(o.matches))},[]),s.jsxs("div",{className:`card daily-chart col flex-1 ${x||""}`,children:[s.jsxs("div",{className:"row justify-space-between",children:[s.jsx("div",{className:"daily-chart-title",children:"Daily Chart"}),s.jsx("div",{className:"row",children:s.jsx("button",{onClick:()=>c(),children:"Update"})})]}),s.jsx("div",{className:"daily-chart-content col flex-1",children:n.length?s.jsx(b,{type:"bar",series:g.reverse(),options:{chart:{toolbar:{show:!1},height:300,zoom:{allowMouseWheelZoom:!1}},colors:["rgb(112, 173, 70)","rgb(90, 155, 213)","rgb(64, 38, 198)","rgb(246, 104, 103)","rgb(153, 107, 31)","rgb(255, 164, 97)"].reverse(),theme:{mode:p?"dark":"light"},dataLabels:{enabled:!1},xaxis:{type:"datetime",labels:{datetimeUTC:!1,format:"dd/MM/yyyy"}},tooltip:{x:{format:"dd/MM/yyyy"},y:{formatter(e){return`${e} kWh`}}},yaxis:[{seriesName:r,title:{text:"Energy (kWh)"}},{seriesName:r,show:!1},{seriesName:r,show:!1},{seriesName:r,show:!1},{seriesName:r,show:!1},{seriesName:r,show:!1}].reverse()}}):s.jsx("div",{className:"col flex-1 justify-center align-center",children:"Loadding..."})})]})}const N=a.memo(w);export{N as default};
