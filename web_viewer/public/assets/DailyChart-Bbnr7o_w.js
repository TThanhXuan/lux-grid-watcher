import{r as t,j as s}from"./index-C7XF5frs.js";import{C as b}from"./react-apexcharts.min-BS367491.js";const r="Solar production";function j({className:x}){const[n,l]=t.useState([]),[p,h]=t.useState(!1),d=t.useRef(!1),g=t.useMemo(()=>{const e=[],o=[],m=[],f=[],u=[],y=[];return n.forEach(a=>{const i=new Date(a[3]).getTime();e.push({x:i,y:a[4]}),o.push({x:i,y:a[5]}),m.push({x:i,y:a[6]}),f.push({x:i,y:a[7]}),u.push({x:i,y:a[8]}),y.push({x:i,y:a[9]})}),[{name:r,data:e},{name:"Battery discharged",data:m},{name:"Battery charged",data:o},{name:"Export to grid",data:u},{name:"Import to user",data:f},{name:"Comsumption",data:y}]},[n]),c=t.useCallback(async()=>{if(d.current)return;d.current=!0;const o=await(await fetch("/daily-chart")).json();l(o),d.current=!1},[l]);return t.useEffect(()=>{c(),document.addEventListener("visibilitychange",()=>{document.hidden||c()})},[c]),t.useEffect(()=>{const e=window.matchMedia("(prefers-color-scheme: dark)");e.matches&&h(!0),e.addEventListener("change",o=>h(o.matches))},[]),s.jsxs("div",{className:`card daily-chart col flex-1 ${x||""}`,children:[s.jsxs("div",{className:"row justify-space-between",children:[s.jsx("div",{className:"daily-chart-title",children:"Daily Chart"}),s.jsx("div",{className:"row",children:s.jsx("button",{onClick:()=>c(),children:"Update"})})]}),s.jsx("div",{className:"daily-chart-content col flex-1",children:n.length?s.jsx(b,{type:"bar",series:g.reverse(),options:{chart:{toolbar:{show:!1},height:300},colors:["rgb(112, 173, 70)","rgb(90, 155, 213)","rgb(64, 38, 198)","rgb(246, 104, 103)","rgb(153, 107, 31)","rgb(255, 164, 97)"].reverse(),theme:{mode:p?"dark":"light"},dataLabels:{enabled:!0},xaxis:{type:"datetime",labels:{datetimeUTC:!1,format:"dd/MM/yyyy"}},tooltip:{x:{format:"dd/MM/yyyy"},y:{formatter(e){return`${e} kWh`}}},yaxis:[{seriesName:r,title:{text:"kWh"}},{seriesName:r,show:!1},{seriesName:r,show:!1},{seriesName:r,show:!1},{seriesName:r,show:!1},{seriesName:r,show:!1}]}}):s.jsx("div",{className:"col flex-1 justify-center align-center",children:"Loadding..."})})]})}const C=t.memo(j);export{C as default};
