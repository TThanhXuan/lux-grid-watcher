const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MonthlyChart-CPAcdl1p.js","assets/index-bn3fLlzU.js","assets/index-DORG5STg.css","assets/react-apexcharts.min-C1JzOHNX.js","assets/utils-bN4E_OZW.js","assets/YearlyChart-DzuPyxxb.js"])))=>i.map(i=>d[i]);
import{r as s,j as e,L as f,_ as b}from"./index-bn3fLlzU.js";import{C as _}from"./react-apexcharts.min-C1JzOHNX.js";import{r as h}from"./utils-bN4E_OZW.js";const i="Solar production",w=s.forwardRef((t,a)=>{const[n,r]=s.useState([]),[m,x]=s.useState(!1),y=s.useRef(!1),N=s.useMemo(()=>{const o=[],l=[],p=[],g=[],j=[],v=[];return n.forEach(c=>{const d=new Date(c[3]).getTime();o.push({x:d,y:h(c[4])}),l.push({x:d,y:h(c[5])}),p.push({x:d,y:h(c[6])}),g.push({x:d,y:h(c[7])}),j.push({x:d,y:h(c[8])}),v.push({x:d,y:h(c[9])})}),[{name:i,data:o},{name:"Battery discharged",data:p},{name:"Battery charged",data:l},{name:"Export to grid",data:j},{name:"Import to user",data:g},{name:"Comsumption",data:v}]},[n]),u=s.useCallback(async()=>{if(y.current)return;y.current=!0;const l=await(await fetch("/daily-chart")).json();r(l),y.current=!1},[r]);return s.useImperativeHandle(a,()=>({fetchChart:u})),s.useEffect(()=>{u(),document.addEventListener("visibilitychange",()=>{document.hidden||u()})},[u]),s.useEffect(()=>{const o=window.matchMedia("(prefers-color-scheme: dark)");o.matches&&x(!0),o.addEventListener("change",l=>x(l.matches))},[]),n.length?e.jsx(_,{type:"bar",series:N.reverse(),options:{chart:{toolbar:{show:!1},height:300,zoom:{allowMouseWheelZoom:!1}},colors:["rgb(112, 173, 70)","rgb(90, 155, 213)","rgb(64, 38, 198)","rgb(246, 104, 103)","rgb(153, 107, 31)","rgb(255, 164, 97)"].reverse(),theme:{mode:m?"dark":"light"},dataLabels:{enabled:!1},xaxis:{type:"datetime",labels:{datetimeUTC:!1,format:"dd/MM/yyyy"}},tooltip:{x:{format:"dd/MM/yyyy"},y:{formatter(o){return`${o} kWh`}}},yaxis:[{seriesName:i,title:{text:"Energy (kWh)"}},{seriesName:i,show:!1},{seriesName:i,show:!1},{seriesName:i,show:!1},{seriesName:i,show:!1},{seriesName:i,show:!1}].reverse()}}):e.jsx(f,{})});w.displayName="DailyChart";const E=s.memo(w),D=s.lazy(()=>b(()=>import("./MonthlyChart-CPAcdl1p.js"),__vite__mapDeps([0,1,2,3,4]))),S=s.lazy(()=>b(()=>import("./YearlyChart-DzuPyxxb.js"),__vite__mapDeps([5,1,2,3,4])));var C=(t=>(t[t.Daily=0]="Daily",t[t.Monthly=1]="Monthly",t[t.Yearly=2]="Yearly",t))(C||{});function k({className:t}){const[a,n]=s.useState(0),r=s.useRef(null);return e.jsxs("div",{className:`card col energy-chart ${t}`,children:[e.jsxs("div",{className:"row justify-space-between",children:[e.jsxs("div",{className:"energy-chart-title",children:[C[a]," chart"]}),e.jsxs("div",{className:"row energy-chart-buttons",children:[e.jsx("button",{onClick:()=>{var m;return(m=r==null?void 0:r.current)==null?void 0:m.fetchChart()},children:"Update chart"}),e.jsx("div",{children:"Chart type:"}),e.jsxs("div",{className:"row chart-select",children:[e.jsx("button",{className:a===0?"active":void 0,onClick:()=>n(0),children:"Daily"}),e.jsx("button",{className:a===1?"active":void 0,onClick:()=>n(1),children:"Monthly"}),e.jsx("button",{className:a===2?"active":void 0,onClick:()=>n(2),children:"Yearly"})]})]})]}),e.jsxs("div",{className:"energy-chart-content flex-1 col",children:[a===0&&e.jsx(E,{ref:r}),a===1&&e.jsx(s.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(D,{ref:r})}),a===2&&e.jsx(s.Suspense,{fallback:e.jsx(f,{}),children:e.jsx(S,{ref:r})})]})]})}const I=s.memo(k);export{I as default};
