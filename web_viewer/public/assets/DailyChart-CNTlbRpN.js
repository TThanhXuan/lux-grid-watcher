import{r as t,j as a}from"./index-HNXD38gs.js";import{C as g}from"./react-apexcharts.min-B6cFfxDy.js";function b({className:y}){const[c,d]=t.useState([]),[p,l]=t.useState(!1),n=t.useRef(!1),x=t.useMemo(()=>{const e=[],r=[],h=[],m=[],u=[],f=[];return c.forEach(s=>{const o=new Date(s[3]).getTime();e.push({x:o,y:s[4]}),r.push({x:o,y:s[5]}),h.push({x:o,y:s[6]}),m.push({x:o,y:s[7]}),u.push({x:o,y:s[8]}),f.push({x:o,y:s[9]})}),[{name:"Solar production",data:e},{name:"Battery discharged",data:h},{name:"Battery charged",data:r},{name:"Export to grid",data:u},{name:"Import to user",data:m},{name:"Comsumption",data:f}]},[c]),i=t.useCallback(async()=>{if(n.current)return;n.current=!0;const r=await(await fetch("/daily-chart")).json();d(r),n.current=!1},[d]);return t.useEffect(()=>{i(),document.addEventListener("visibilitychange",()=>{document.hidden||i()})},[i]),t.useEffect(()=>{const e=window.matchMedia("(prefers-color-scheme: dark)");e.matches&&l(!0),e.addEventListener("change",r=>l(r.matches))},[]),a.jsxs("div",{className:`card daily-chart col flex-1 ${y||""}`,children:[a.jsxs("div",{className:"row justify-space-between",children:[a.jsx("div",{className:"daily-chart-title",children:"Daily Chart"}),a.jsx("div",{className:"row",children:a.jsx("button",{onClick:()=>i(),children:"Update"})})]}),a.jsx("div",{className:"daily-chart-content col flex-1",children:c.length?a.jsx(g,{type:"bar",series:x,options:{chart:{toolbar:{show:!1},height:300},colors:["rgb(112, 173, 70)","rgb(90, 155, 213)","rgb(64, 38, 198)","rgb(246, 104, 103)","rgb(153, 107, 31)","rgb(255, 164, 97)"],theme:{mode:p?"dark":"light"},dataLabels:{enabled:!1},xaxis:{type:"datetime",labels:{datetimeUTC:!1,format:"dd/MM/yyyy"}},tooltip:{x:{format:"dd/MM/yyyy"},y:{formatter(e){return`${e} kWh`}}},yaxis:[{seriesName:"Solar production",title:{text:"kWh"}},{seriesName:"Solar production",show:!1},{seriesName:"Solar production",show:!1},{seriesName:"Solar production",show:!1},{seriesName:"Solar production",show:!1},{seriesName:"Solar production",show:!1}]}}):a.jsx("div",{className:"col flex-1 justify-center align-center",children:"Loadding..."})})]})}const w=t.memo(b);export{w as default};
